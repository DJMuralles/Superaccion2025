<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Prototipo Superacci칩n 2025</title>
    <link rel="icon" href="Logo.png" type="image/png">
    <!--Iconos de Google-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"/>
    <!--Estilo CSS-->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@100..900&display=swap');
        /*Tipo de letra*/
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Roboto", sans-serif;
        }
        /*Centra el bot*/
        body{
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(#def0f7,#85c7e0);
        }
        /*Dise침o del bot*/
        .chatbot{
            position: relative;
            width: 420px;
            background: #fff;
            overflow: hidden;
            border-radius: 15px;
        }
        /*Dise침o del encabezado*/
        .encabezado-chatbot{
            display: flex;
            align-items: center;
            background: #2cee7a;
            padding: 15px 22px;
            justify-content: space-between;
        }
        .encabezado-chatbot .informacion-chatbot{
            display: flex;
            gap: 10px;
            align-items: center;
        }
        /*Dise침o del logo*/
        .informacion-chatbot .logo{
            height: 35px;
            width: 35px;
            padding: 6px;
            fill:#2cee7a;
            flex-shrink: 0;
            background: #fff;
            border-radius: 50%;
        }
        .informacion-chatbot .texto-logo{
            color: #fff;
            font-size: 1.4rem;
            font-weight: 500;
        }
        /*Dise침o de la parte de mensajes*/
        .cuerpo-chatbot{
            padding: 25px 22px;
            display: flex;
            gap: 20px;
            height: 460px;
            margin-bottom: 82px;
            overflow-y: auto;
            flex-direction: column;
        }
        .cuerpo-chatbot .mensaje{
            display: flex;
            gap: 11px;
            align-items: center;
        }
        .cuerpo-chatbot .mensaje .img-bot{
            height: 34px;
            width: 35px;
            padding: 6px;
            fill: #fff;
            align-self: flex-end;
            margin-bottom: 2px;
            flex-shrink: 0;
            background: #2cee7a;
            border-radius: 50%;  
        }
        .cuerpo-chatbot .mensaje-usuario{
            flex-direction: column;
            align-items: flex-end;
        }
        .cuerpo-chatbot .mensaje .mensaje-txt{
            padding: 12px 16px;
            max-width: 75%;
            font-size: 0.95rem;
        }
        .cuerpo-chatbot .mensaje-bot .mensaje-txt{
            background:#d7fff0 ;
            border-radius: 13px 13px 13px 3px;
        }
        .cuerpo-chatbot .mensaje-usuario .mensaje-txt{
            color: #fff;
            background:#2cee7a ;
            border-radius: 13px 13px 3px 13px;
        }
        /*Creaci칩n de los puntos*/
        .cuerpo-chatbot .mensaje-bot .pensando-an {
            display: flex;
            gap: 6px;
            padding-block: 12px;
            justify-content: center;
            align-items: center;
        }
        /*Animaci칩n de los puntos*/
        .cuerpo-chatbot .mensaje-bot .pensando-an .punto {
            width: 8px;
            height: 8px;
            background-color: #2cee7a;
            border-radius: 50%;
            opacity: 0.6;
            animation: puntos 1.3s infinite ease-in-out;
        }
        /*Para el punto 1*/
        .cuerpo-chatbot .mensaje-bot .pensando-an .punto:nth-child(1) {
            animation-delay: 0s;
        }
        /*Para el punto 2*/
        .cuerpo-chatbot .mensaje-bot .pensando-an .punto:nth-child(2) {
            animation-delay: 0.2s;
        }
        /*Para el punto 3*/
        .cuerpo-chatbot .mensaje-bot .pensando-an .punto:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes puntos {
            0%, 80%, 100% {
                transform: translateY(0);
                opacity: 0.6;
            }
            40% {
                transform: translateY(-6px);
                opacity: 1;
            }
        }
        /*Dise침o para mandar mensajes*/
        .salida-chatbot{
            position: absolute;
            bottom: 0;
            width: 100%;
            background: #fff;
            padding: 15px 22px 20px;
        /*Caja de texto*/
        }
        .salida-chatbot .chat{
            display: flex;
            align-items: center;
            background: #fff;
            border-radius: 32px;
            outline: 1px solid #d7fff0;
        }
        .salida-chatbot .chat:focus-within{
            outline: 2px solid #2cee7a;
        }
        .chat .entrada-mensaje{
            border: none;
            outline: none;
            height: 47px;
            width: 100%;
            resize: none;
            font-size: 0.95rem;
            padding: 4px 0 13px 18px;
            border-radius: inherit;
        }
        .chat .enviar{
            display: flex;
            height: 47px;
            gap: 3px;
            align-items: center;
            align-self: flex-end;
            padding-right:6px ;
        }
       
        /*Dise침o del bot칩n*/
        .chat .enviar .bot{
            height: 35px;
            width: 35px;
            border: none;
            font-size: 1.15rem;
            cursor: pointer;
            color: #2cee7a;
            background:#d7fff0 ;
            border-radius: 50%;
            transition: 0.2s ease;
        }
        .chat .enviar .bot:hover{
            color: #d7fff0;
            background:#2cee7a;   
        }
        
    </style>
</head>  
<body>
    <div class="chatbot">
        <!--Encabezado-->
        <div class="encabezado-chatbot">
            <div class="informacion-chatbot">
            <!--Dise침o del robot-->
            <svg class="logo" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 1024 1024">
                <path d="M738.3 287.6H285.7c-59 0-106.8 47.8-106.8 106.8v303.1c0 59 47.8 106.8 106.8 106.8h81.5v111.1c0 .7.8 1.1 1.4.7l166.9-110.6 41.8-.8h117.4l43.6-.4c59 0 106.8-47.8 106.8-106.8V394.5c0-59-47.8-106.9-106.8-106.9zM351.7 448.2c0-29.5 23.9-53.5 53.5-53.5s53.5 23.9 53.5 53.5-23.9 53.5-53.5 53.5-53.5-23.9-53.5-53.5zm157.9 267.1c-67.8 0-123.8-47.5-132.3-109h264.6c-8.6 61.5-64.5 109-132.3 109zm110-213.7c-29.5 0-53.5-23.9-53.5-53.5s23.9-53.5 53.5-53.5 53.5 23.9 53.5 53.5-23.9 53.5-53.5 53.5zM867.2 644.5V453.1h26.5c19.4 0 35.1 15.7 35.1 35.1v121.1c0 19.4-15.7 35.1-35.1 35.1h-26.5zM95.2 609.4V488.2c0-19.4 15.7-35.1 35.1-35.1h26.5v191.3h-26.5c-19.4 0-35.1-15.7-35.1-35.1zM561.5 149.6c0 23.4-15.6 43.3-36.9 49.7v44.9h-30v-44.9c-21.4-6.5-36.9-26.3-36.9-49.7 0-28.6 23.3-51.9 51.9-51.9s51.9 23.3 51.9 51.9z"></path>
            </svg>
                <h2 class="texto-logo">Medibot</h2>
            </div>
        </div>
        <!--Cuerpo (que dir치 el chatbot)-->
        <div class="cuerpo-chatbot">
            <div class="mensaje mensaje-bot">
                <div class="mensaje-txt">Hola soy Medibot游녦 <br> 쮺칩mo puedo ayudarte?</div>
            </div>
        </div>
        <!--Salida (que se le dir치 al chatbot)-->
        <div class="salida-chatbot">
            <form action="#" class="chat">
                <textarea id="txt"placeholder="Mensaje..."class="entrada-mensaje"></textarea>

                <div class="enviar">
                    <button id="env"class="material-symbols-outlined bot">send</button>    
                </div>
            </form>
        </div>
    </div>
    <!--JavaScript-->
    <script>
        const textarea = document.getElementById('txt');
        const boton = document.getElementById('env');
        const cuerpochat = document.querySelector(".cuerpo-chatbot");

        // API
        const API_KEY = "AIzaSyD3PjFKxjgDTiQPfY-FKpJGStSrLEM42aU";
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`;

        const crearCaja = (contenido, clases) => {
            const div = document.createElement("div");
            div.classList.add("mensaje", clases);
            div.innerHTML = contenido;
            return div;
        }
        //Configuraci칩n de Medibot
        const systemInstruction={
            parts: [{
                text: 'Eres un asistente virtual mdico. Tienes que preguntarle los s칤ntomas al paciente sobre qu칠 tiene y desde hace cuando lo tiene. A partir de ello, dile la enfermedad probable que padezca. Asismismo pregunta: edad, sexo, altura, peso e 칤ndice de masa corporal (cuando ya lo tengas, no lo vuelvas a preguntar), todo con el fin de brindarle ayuda, dale medicamentos para poder tratar la enfermedad, que sean accesibles, si es muy grave la enfermedad, dale el n칰mero de tel칠fono de asistencia de Guatemala para que pueda llamar por ayuda m치s especializada'
            }]
        }
        
        const respuestaIa = async (mensaje, salida) => {
            const mensajeEl = salida.querySelector(".mensaje-txt");
            mensajeEl.classList.add("thinking");

            const requerirOpciones = {
               
                method: "POST",
                headers: { "Content-Type": "application/json" },
                
                body: JSON.stringify({
                    systemInstruction,
                    contents: [{
                        parts: [{ text: mensaje}]
                    }]
                })
            }

            try {
                const respuesta = await fetch(API_URL, requerirOpciones);
                const datos = await respuesta.json();

                if (!respuesta.ok) throw new Error(datos.error.message);

                const respuestaIA = datos.candidates[0].content.parts[0].text.replace(/\*\*/g, '').trim();
                mensajeEl.innerText = respuestaIA;
            } catch (error) {
                console.error(error);
                mensajeEl.innerText = "Error al obtener respuesta de la IA";
            } finally {
                mensajeEl.classList.remove("thinking");
            }
        }

        const enviarmensaje = (e) => {
            e.preventDefault();

            const mensaje = textarea.value.trim();
            if (!mensaje) return;

            const contenido = `<div class="mensaje-txt">${mensaje}</div>`;
            const division = crearCaja(contenido, "mensaje-usuario");
            cuerpochat.appendChild(division);

            const contenidoBot = `
                <svg class="img-bot" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 1024 1024">
                    <path d="M738.3 287.6H285.7c-59 0-106.8 47.8-106.8 106.8v303.1c0 59 47.8 106.8 106.8 106.8h81.5v111.1c0 .7.8 1.1 1.4.7l166.9-110.6 41.8-.8h117.4l43.6-.4c59 0 106.8-47.8 106.8-106.8V394.5c0-59-47.8-106.9-106.8-106.9zM351.7 448.2c0-29.5 23.9-53.5 53.5-53.5s53.5 23.9 53.5 53.5-23.9 53.5-53.5 53.5-53.5-23.9-53.5-53.5zm157.9 267.1c-67.8 0-123.8-47.5-132.3-109h264.6c-8.6 61.5-64.5 109-132.3 109zm110-213.7c-29.5 0-53.5-23.9-53.5-53.5s23.9-53.5 53.5-53.5 53.5 23.9 53.5 53.5-23.9 53.5-53.5 53.5zM867.2 644.5V453.1h26.5c19.4 0 35.1 15.7 35.1 35.1v121.1c0 19.4-15.7 35.1-35.1 35.1h-26.5zM95.2 609.4V488.2c0-19.4 15.7-35.1 35.1-35.1h26.5v191.3h-26.5c-19.4 0-35.1-15.7-35.1-35.1zM561.5 149.6c0 23.4-15.6 43.3-36.9 49.7v44.9h-30v-44.9c-21.4-6.5-36.9-26.3-36.9-49.7 0-28.6 23.3-51.9 51.9-51.9s51.9 23.3 51.9 51.9z"></path>
                </svg>
                <div class="mensaje-txt pensando-an">
                    <div class="punto"></div>
                    <div class="punto"></div>
                    <div class="punto"></div>
                </div>
            `;
            const salida = crearCaja(contenidoBot, "mensaje-bot");
            cuerpochat.appendChild(salida);

            cuerpochat.scrollTop = cuerpochat.scrollHeight;

            respuestaIa(mensaje, salida);

            textarea.value = '';
            boton.style.display = 'none';
        }
        textarea.addEventListener('input', () => {
            if (textarea.value.trim() !== '') {
                boton.style.display = 'inline-block';
            } else {
                boton.style.display = 'none';
            }
        });
        textarea.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                enviarmensaje(e);
            }
        });
        boton.addEventListener("click", (e) => enviarmensaje(e));
    </script>
</body>
</html>
